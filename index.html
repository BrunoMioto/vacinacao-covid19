<!doctype html>
<html lang="pt-BR">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css">
		<link rel="stylesheet" href="//cdn.datatables.net/1.10.23/css/dataTables.bootstrap4.min.css">
		<link rel="preconnect" href="//fonts.gstatic.com">
		<link rel="stylesheet" href="//fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap">
		<title>Vacinas (COVID-19) aplicadas em cada país</title>
		<style>
			body {
				font-family: 'Roboto', sans-serif;
			}
			html {
				height: -webkit-fill-available;
			}
			.dataTables_filter {
				margin-top: .5rem;
				padding-right: .5rem;
			}
			.dataTables_filter label {
				margin-bottom: .1rem;
			}
			.dataTables_filter input {
				display: block;
				width: 100%;
				padding: .375rem;
				font-size: 1rem;
				line-height: 1em;
				color: #495057;
				background-color: #fff;
				background-clip: padding-box;
				border: 1px solid #ced4da;
				border-radius: .25rem;
				transition: border-color .15s ease-in-out,box-shadow .15s ease-in-out;
			}
			.v {
				background-color: #f4f4f4;
				color: #fff;
			}
			.v-pfizer-biontech {
				background-color: #377eb8;
			}
			.v-sputnik-v {
				background-color: #e41a1c;
			}
			.v-sinopharm {
				background-color: #4daf4a;
			}
			.v-moderna {
				background-color: #ffff33;
				color: #000;
			}
			.v-cnbg {
				background-color: #984ea3;
			}
			.v-sinovac {
				background-color: #ff7f00;
			}
			
			.loading {
				position: fixed;
				top: 0;
				left: 0;
				right: 0;
				bottom: 0;
				background: #fff;
				z-index: 999;
			}
			.spinner {
				position: fixed;
				top: 50%;
				left: 50%;
				color: official;
				display: inline-block;
				position: relative;
				width: 80px;
				height: 80px;
				margin-top: -40px;
				margin-left: -40px;
			}
			.spinner div {
				transform-origin: 40px 40px;
				animation: lds-spinner 1.2s linear infinite;
			}
			.spinner div:after {
				content: " ";
				display: block;
				position: absolute;
				top: 3px;
				left: 37px;
				width: 6px;
				height: 18px;
				border-radius: 20%;
				background: #b0b0b0;
			}
			.spinner div:nth-child(1) {
				transform: rotate(0deg);
				animation-delay: -1.1s;
			}
			.spinner div:nth-child(2) {
				transform: rotate(30deg);
				animation-delay: -1s;
			}
			.spinner div:nth-child(3) {
				transform: rotate(60deg);
				animation-delay: -0.9s;
			}
			.spinner div:nth-child(4) {
				transform: rotate(90deg);
				animation-delay: -0.8s;
			}
			.spinner div:nth-child(5) {
				transform: rotate(120deg);
				animation-delay: -0.7s;
			}
			.spinner div:nth-child(6) {
				transform: rotate(150deg);
				animation-delay: -0.6s;
			}
			.spinner div:nth-child(7) {
				transform: rotate(180deg);
				animation-delay: -0.5s;
			}
			.spinner div:nth-child(8) {
				transform: rotate(210deg);
				animation-delay: -0.4s;
			}
			.spinner div:nth-child(9) {
				transform: rotate(240deg);
				animation-delay: -0.3s;
			}
			.spinner div:nth-child(10) {
				transform: rotate(270deg);
				animation-delay: -0.2s;
			}
			.spinner div:nth-child(11) {
				transform: rotate(300deg);
				animation-delay: -0.1s;
			}
			.spinner div:nth-child(12) {
				transform: rotate(330deg);
				animation-delay: 0s;
			}
			@keyframes lds-spinner {
				0% {
					opacity: 1;
				}
				100% {
					opacity: 0;
				}
			}
			.table thead th {
				vertical-align: middle;
				border-bottom-color: #000;
			}
			
			table.dataTable.table-sm .sorting:after,
			table.dataTable.table-sm .sorting_asc:after,
			table.dataTable.table-sm .sorting_desc:after,
			table.dataTable.table-sm .sorting:before,
			table.dataTable.table-sm .sorting_asc:before,
			table.dataTable.table-sm .sorting_desc:before {
				top: 30% !important;
			}
		</style>
	</head>
	<body>
		<table id="DataTable" class="display table table-sm table-striped w-100">
			<thead>
				<tr>
					<th></th>
					<th>Local</th>
					<th>Vacinas</th>
					<th class="text-nowrap">Última vacinação</th>
					<th class="text-nowrap">Doses aplicadas<br/>por 100 habitantes</th>
					<th class="text-nowrap">Doses aplicadas</th>
				</tr>
			</thead>
			<tbody>
			</tbody>
		</table>
		<small class="p-2 m-0 text-secondary">
			Dados obtidos a partir de fontes oficiais. Apenas países que divulgaram o número de doses aplicadas.
		</small>
		<div class="loading">
			<div class="spinner"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div>
		</div>
		<script src="//cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
		<script src="//cdn.datatables.net/1.10.23/js/jquery.dataTables.min.js"></script>
		<script>
			jQuery.extend( jQuery.fn.dataTableExt.oSort, {
				"portugues-pre": function ( data ) {
					var a = 'a';
					var e = 'e';
					var i = 'i';
					var o = 'o';
					var u = 'u';
					var c = 'c';
					var special_letters = {
						"Á": a, "á": a, "Ã": a, "ã": a, "À": a, "à": a,
						"É": e, "é": e, "Ê": e, "ê": e,
						"Í": i, "í": i, "Î": i, "î": i,
						"Ó": o, "ó": o, "Õ": o, "õ": o, "Ô": o, "ô": o,
						"Ú": u, "ú": u, "Ü": u, "ü": u,
						"ç": c, "Ç": c
					};
					for (var val in special_letters)
					   data = data.split(val).join(special_letters[val]).toLowerCase();
					return data;
				},
				"portugues-asc": function ( a, b ) {
					return ((a < b) ? -1 : ((a > b) ? 1 : 0));
				},
				"portugues-desc": function ( a, b ) {
					return ((a < b) ? 1 : ((a > b) ? -1 : 0));
				}
			});

			$(document).ready( function () {
				var jqxhr = $.getJSON( "owid.json", function(data) {
					$.each(data,function(i, data){
						var n = i + 1;
						var date = data.last_update_date.split('-');
						var vaccines = '';
						
						$.each(data.vaccines,function(i, data){
							var c = data.toLowerCase().replace(' ','-').replace('/','-')
							vaccines += '<div class="p-1 d-block w-100 h-100 text-center v v-'+c+'">'+data+'</div>';
						});

						$('#DataTable > tbody').append('<tr>'+
						'<td class="font-weight-bold">'+n+'</td>'+
						'<td><div class="d-flex align-items-center text-nowrap"><img class="d-inline-block mr-2" src="https://cdn.jsdelivr.net/gh/hjnilsson/country-flags/svg/'+data.iso_code.alpha2+'.svg" width="20" />'+data.country_pt+'</div></td>'+
						'<td class="p-0 d-flex">'+vaccines+'</td>'+
						'<td class="text-center">'+date[2]+'/'+date[1]+'/'+date[0]+'</td>'+
						'<td>'+data.total_vaccinations_per_hundred+'</td>'+
						'<td>'+data.vaccinations_total+'</td>'+
						'</tr>');
					});
				})
				.done(function(data) {
					$('#DataTable').DataTable( {
						"paging": false,
						"info": false,
						"order": [[ 1, "asc" ]],
						"language": {
							url: '//cdn.datatables.net/plug-ins/1.10.22/i18n/Portuguese-Brasil.json'
						},
						//"columnDefs": [{ type: 'portugues', targets: 1 }]
					});
					$('.loading').fadeOut(500, function() {
						$(this).remove();
					});
				})
			});
		</script>
	</body>
</html>